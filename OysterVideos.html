<!-- <iframe
  title="1"
  allowtransparency="true"
  frameborder="0"
  scrolling="no"
  class="wistia_embed"
  name="wistia_embed"
  allowfullscreen=""
  mozallowfullscreen=""
  webkitallowfullscreen=""
  oallowfullscreen=""
  msallowfullscreen=""
  style="zoom: 2"
  height="200px"
  width="300px"
  srcdoc=' -->
<div style="width: 500px" class="iframe-wrapper">
  <script
    src="https://fast.wistia.com/embed/medias/roc17q5zlb.jsonp"
    async
  ></script>
  <script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
  <div
    class="wistia_responsive_padding"
    style="padding: 56.25% 0 0 0; position: relative"
  >
    <div
      class="wistia_responsive_wrapper"
      style="height: 100%; left: 0; position: absolute; top: 0; width: 100%"
    >
      <div
        class="wistia_embed wistia_async_roc17q5zlb seo=false videoFoam=true"
        style="height: 100%; position: relative; width: 100%"
      >
        <div
          class="wistia_swatch"
          style="
            height: 100%;
            left: 0;
            opacity: 0;
            overflow: hidden;
            position: absolute;
            top: 0;
            transition: opacity 200ms;
            width: 100%;
          "
        >
          <img
            src="https://fast.wistia.com/embed/medias/roc17q5zlb/swatch"
            style="
              filter: blur(5px);
              height: 100%;
              object-fit: contain;
              width: 100%;
            "
            alt=""
            aria-hidden="true"
            onload="this.parentNode.style.opacity=1;"
          />
        </div>
      </div>
    </div>
  </div>
</div>
<div style="width: 500px; height: 300px; background-color: gray">
  <h2 style="width: 80%; margin: auto">Transcript</h2>
  <hr />
  <div
    id="Transcript"
    style="width: 80%; margin: auto; height: 200px; overflow: auto"
  ></div>
</div>
<script>
  const WistiaURL = "roc17q5zlb"; // Replace with your actual Wistia URL
  const WistiaHeaders = {
    // Add your headers here, e.g., API keys or authentication tokens
    Authorization: "Bearer YOUR_API_KEY",
  };
  const options = {
    headers: {
      Authorization:
        "Bearer 185e6a59d70559fdf59fe891201cf3f96d0c6e645b9aa4e7e1f0bf645ad2bed9",
    },
    method: "get",
  };
  fetch(`https://api.wistia.com/v1/medias/${WistiaURL}/captions.json`, options)
    .then((response) => response.json())
    .then((data) => {
      // Handle the response data here
      document.getElementById("Transcript").innerHTML = "";
      // console.log(data[0].text.split("-->"));
      const captionBlocks = data[0].text.split("\n\n");

      // Extract spoken content from each caption block

      // Extract and display the spoken content with timestamps
      captionBlocks.forEach((block, index) => {
        // Split the block into lines
        const lines = block.split("\n");

        // Extract the timestamp (line 1)
        const timestamp = lines[1];
        // console.log(timestamp, lines);
        // Extract the spoken content (lines starting from the 2nd line)
        const spokenLines = lines.slice(2);
        const spokenText = spokenLines.join(" ");

        // Create a new <p> element
        const pElement = document.createElement("p");

        // Set the id attribute of the <p> element with the timestamp
        pElement.id = timestamp.split(" --> ").join("/");

        // Set the innerHTML of the <p> element with the spoken content
        pElement.innerHTML = spokenText;
        // console.log(pElement);
        document.getElementById("Transcript").appendChild(pElement);
        // Append the <p> element to the container
        // container.appendChild(pElement);
      });
      // let arr = data[0].text.split("-->");
      // console.log(data[0].text)
      // for (let i = 0; i < arr.length; i++) {
      //   // console.log(arr[i]);
      //   const result = arr[i].split(/\n(?=\d+\n)/);

      //   // console.log(result);
      // }
    })
    .catch((error) => {
      // Handle any errors that occur during the request
      console.error(error);
    });
  window._wq = window._wq || [];
  _wq.push({
    id: "roc17q5zlb",
    options: {
      plugin: {
        "captions-v1": {
          onByDefault: true,
          language: "eng",
        },
      },
      time: "roc17q5zlb",
    },
    onReady: function (video) {
      // console.log(video.data.media.captions[0].text.split("\n"));
      document.getElementById("Transcript").innerHTML =
        video.data.media.captions[0].text;
      video.playbackRate("{{playRate}}");
      video.bind("playbackratechange", function (playbackRate) {
        document.getElementById("playRate").value = playbackRate;
      });

      video.bind("play", function () {
        document.getElementById("autoScroll").innerHTML = "on";
      });

      video.bind("pause", function () {
        CCs = getCCs();
        console.log(CCs);
        for (let i = 0; i < CCs.length; i++) {
          elmnt = document.getElementById(CCs[i][0] + "/" + CCs[i][1]);
          if (elmnt.style.color == "black") {
            elmnt.focus();
          }
        }
      });

      video.bind("seek", function () {
        CCs = getCCs();
        for (let i = 0; i < CCs.length; i++) {
          document.getElementById("autoScroll").innerHTML = "on";
        }
      });
      function timecodeToSeconds(timecode) {
        const parts = timecode.split(":");
        const hours = parseInt(parts[0], 10);
        const minutes = parseInt(parts[1], 10);
        const seconds = parseFloat(parts[2].replace(",", "."));
        return hours * 3600 + minutes * 60 + seconds;
      }
      // Hilights the element that is currently playing
      video.bind("timechange", function () {
        let element = document.getElementById("Transcript");
        let allElements = element.querySelectorAll("p");
        console.log(allElements[0]);
        for (let i = 0; i < allElements.length; i++) {
          let timeStamps = allElements[i].id.split("/");
          let start = timecodeToSeconds(timeStamps[0]);
          let end = timecodeToSeconds(timeStamps[1]);
          // console.log(video.time(), start, end);
          if (video.time() >= start && video.time() <= end) {
            console.log(true);
            allElements[i].focus();
            allElements[i].style.color = "red";

            allElements[i].scrollIntoView();
          } else {
            allElements[i].blur();
            allElements[i].style.color = "black";
          }
        }
        // document.getElementById("VidTime").value = video.time();
        // var functions = document.getElementsByClassName("function");
        // for (let i = 0; i < functions.length; i++) {
        //   start = functions[i].parentNode.id.split("/")[0];
        //   end = functions[i].parentNode.id.split("/")[1];
        //   if (video.time() >= start && video.time() < end) {
        //     functions[i].style.backgroundColor = "#62a7d1";
        //     functions[i].style.color = "black";
        //   } else {
        //     functions[i].style.backgroundColor = "#1E252B";
        //     functions[i].style.color = "#DDDDDD";
        //   }
        // }

        // CCs = getCCs();
        // for (let i = 0; i < CCs.length; i++) {
        //   elmnt = document.getElementById(CCs[i][0] + "/" + CCs[i][1]);
        //   if (video.time() >= CCs[i][0] && video.time() <= CCs[i][0] + 1) {
        //     elmnt.style.border = "2px solid #fc4b00";
        //     if (elmnt.className.includes("sub")) {
        //       elmnt.className = elmnt.className.replace("Inactive", "Active");
        //     }
        //   } else if (video.time() > CCs[i][0] && video.time() < CCs[i][1]) {
        //     elmnt.style.border = "2px solid transparent";
        //     if (elmnt.className.includes("sub")) {
        //       elmnt.className = elmnt.className.replace("Inactive", "Active");
        //     }

        //     if (
        //       isInViewport(elmnt) == false &&
        //       document.getElementById("autoScroll").innerHTML == "on"
        //     ) {
        //       elmnt.scrollIntoView();
        //     }
        //   } else {
        //     elmnt.style.border = "2px solid transparent";
        //     if (elmnt.className.includes("sub")) {
        //       elmnt.className = elmnt.className.replace("Active", "Inactive");
        //     }
        //   }
        // }
      });
    },
  });
</script>
<!-- '
></iframe> -->
